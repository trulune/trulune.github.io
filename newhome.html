<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trulune Malaysia</title>
    
<!-- In your head section, update Firebase scripts -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<!-- Add Auth -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- HTML2Canvas for share feature -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Lato', sans-serif;
        }
        
        body {
            color: #FFFFFF;
            min-height: 100vh;
            background: 
                radial-gradient(ellipse at 20% 10%, rgba(14, 54, 89, 0.8) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 90%, rgba(24, 45, 64, 0.8) 0%, transparent 50%),
                radial-gradient(ellipse at 40% 40%, rgba(12, 29, 47, 0.9) 0%, transparent 60%),
                radial-gradient(ellipse at 60% 60%, rgba(14, 54, 89, 0.6) 0%, transparent 55%),
                radial-gradient(ellipse at 10% 70%, rgba(28, 65, 100, 0.5) 0%, transparent 45%),
                radial-gradient(ellipse at 90% 30%, rgba(20, 40, 60, 0.6) 0%, transparent 45%),
                linear-gradient(135deg, #0c1d2f 0%, #182D40 50%, #0E3659 100%);
            background-attachment: fixed;
            display: flex;
            flex-direction: column;
        }
        
        a {
            text-decoration: none;
            color: inherit;
        }
        
        /* Header - Transparent initially, sticky on scroll */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 1rem 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            background-color: transparent;
            backdrop-filter: blur(0px);
            transition: all 0.4s ease;
        }
        
        .header.scrolled {
            background-color: rgba(12, 29, 47, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            padding: 0.7rem 0;
        }
        
        .header-container {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* Logo with image */
        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .logo-image {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid rgba(211, 206, 215, 0.3);
        }
        
        .logo-text {
            font-size: 1.3rem;
            font-weight: 700;
            color: #FFFFFF;
            line-height: 1.2;
        }
        
        .logo-text span {
            color: #d3ced7;
            display: block;
            font-size: 0.9rem;
            font-weight: 400;
        }
        
        /* Mobile Menu Toggle - PLAIN */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: #FFFFFF;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            z-index: 1002;
        }
        
        /* Menu header - PLAIN */
        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }
        
        .nav-links a {
            padding: 0.5rem 0;
            font-weight: 400;
            color: #FFFFFF;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }
        
        .nav-links a:hover {
            color: #d3ced7;
        }
        
        .nav-links .active {
            color: #d3ced7;
            font-weight: 700;
            position: relative;
        }
        
        .nav-links .active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, #0E3659, #d3ced7);
            border-radius: 2px;
        }
        
        /* Featured Image Slider - FIXED 1920x1080 Aspect Ratio, SAME SPACING AS OTHER SECTIONS */
        .hero-section {
            position: relative;
            max-width: 1150px;
            width: 100%;
            height: 350px;
            margin: 100px auto 0 auto; /* Removed bottom margin */
            overflow: hidden;
            border-radius: 8px;
            border: 1px solid rgba(14, 54, 89, 0.3);
        }
        
        .slider-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            background-size: cover;
            background-position: center;
            border-radius: 12px;
        }
        
        .slide.active {
            opacity: 1;
        }
        
        /* Slide 1 - REMOVED OPACITY/OVERLAY */
        .slide-1 {
            background: url('https://images.unsplash.com/photo-1619566636858-adf3ef46400b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&h=1080&q=80');
            background-size: cover;
            background-position: center;
        }
        
        /* Slide 2 - REMOVED OPACITY/OVERLAY */
        .slide-2 {
            background: url('https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&h=1080&q=80');
            background-size: cover;
            background-position: center;
        }
        
        .slider-indicators {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 10px;
            z-index: 10;
        }
        
        .indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .indicator.active {
            background: #FFFFFF;
        }
        
        /* Main Content */
        .container {
            flex: 1;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            padding: 0 1.5rem;
        }
        
        /* Fruitee Series Section - REMOVED EXCESSIVE PADDING */
        .series-section {
            padding: 0.5rem 0; /* Reduced padding */
            margin: 30px 0 0 0; /* Only 10px top margin, no bottom */
        }
        
        .section-title {
            font-size: 2.2rem;
            margin-bottom: 0.3rem; /* Reduced */
            color: #FFFFFF;
            text-align: center;
        }
        
        .section-subtitle {
            font-size: 1.1rem;
            margin-bottom: 1rem; /* Reduced */
            color: #d3ced7;
            text-align: center;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Product Grid - Desktop: 3 columns, Tablet: 2 columns, Mobile: 2 columns */
        .products {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem; /* Reduced gap */
            margin-bottom: 1rem; /* Reduced */
        }
        
        /* Make product cards clickable for ALL views */
        .product-card {
            background: rgba(24, 45, 64, 0.3);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(14, 54, 89, 0.3);
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
            height: 100%;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            border-color: rgba(14, 54, 89, 0.6);
        }
        
        /* Product hover interaction */
        .product-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #0E3659, #182D40);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .product-card:hover::after {
            transform: scaleX(1);
        }
        
        /* Product Image with Carousel */
        .product-img-container {
            width: 100%;
            height: 0;
            padding-bottom: 100%;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #0E3659 0%, #182D40 100%);
        }
        
        .product-img-carousel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            transition: transform 0.5s ease;
        }
        
        .carousel-slide {
            min-width: 100%;
            height: 100%;
            position: relative;
        }
        
        .carousel-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        /* Carousel Navigation Arrows */
        .carousel-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(12, 29, 47, 0.7);
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            font-size: 1rem;
            transition: all 0.3s;
            opacity: 0;
        }
        
        .carousel-arrow:hover {
            background: rgba(12, 29, 47, 0.9);
        }
        
        .product-img-container:hover .carousel-arrow {
            opacity: 1;
        }
        
        .carousel-arrow-left {
            left: 10px;
        }
        
        .carousel-arrow-right {
            right: 10px;
        }
        
        .carousel-dots {
            position: absolute;
            bottom: 12px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 6px;
            z-index: 5;
        }
        
        .carousel-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .carousel-dot.active {
            background: #FFFFFF;
        }
        
        .product-info {
            padding: 1.2rem; /* Reduced */
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .product-name {
            font-size: 1.2rem;
            margin-bottom: 0.3rem; /* Reduced */
            color: #FFFFFF;
            font-weight: 600;
            line-height: 1.3;
        }
        
        .product-price {
            font-size: 1.2rem;
            font-weight: 700;
            color: #FFFFFF;
            margin: 0.3rem 0 0.8rem 0; /* Reduced */
            display: block;
        }
        
        /* Get Your Now Button with Gradient */
        .buy-button {
            background: linear-gradient(135deg, #0E3659 0%, #182D40 100%);
            color: #FFFFFF;
            border: none;
            padding: 0.8rem; /* Reduced */
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            text-align: center;
            border: 1px solid rgba(211, 206, 215, 0.2);
            display: block;
            position: relative;
            overflow: hidden;
            width: 100%;
            margin-top: auto;
        }
        
        .buy-button:hover {
            background: linear-gradient(135deg, #182D40 0%, #0E3659 100%);
            color: #FFFFFF;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(14, 54, 89, 0.4);
        }
        
        /* Product Modal for ALL views - UPDATED LAYOUT */
        .product-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }
        
        .product-modal.active {
            display: flex;
        }
        
        .product-modal-content {
            background: rgba(24, 45, 64, 0.95);
            border-radius: 12px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(14, 54, 89, 0.5);
            position: relative;
            display: flex;
            flex-direction: row;
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(12, 29, 47, 0.8);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-product-img-container {
            width: 50%;
            min-height: 400px;
            position: relative;
            overflow: hidden;
            border-radius: 12px 0 0 12px;
            background: linear-gradient(135deg, #0E3659 0%, #182D40 100%);
            flex-shrink: 0;
        }
        
        .modal-product-img-carousel {
            width: 100%;
            height: 100%;
            display: flex;
            transition: transform 0.5s ease;
        }
        
        .modal-carousel-slide {
            min-width: 100%;
            height: 100%;
        }
        
        .modal-carousel-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .modal-carousel-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(12, 29, 47, 0.7);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            font-size: 1.2rem;
            transition: all 0.3s;
        }
        
        .modal-carousel-arrow:hover {
            background: rgba(12, 29, 47, 0.9);
        }
        
        .modal-carousel-arrow-left {
            left: 10px;
        }
        
        .modal-carousel-arrow-right {
            right: 10px;
        }
        
        .modal-carousel-dots {
            position: absolute;
            bottom: 15px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 8px;
            z-index: 5;
        }
        
        .modal-carousel-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .modal-carousel-dot.active {
            background: #FFFFFF;
        }
        
        .modal-product-info {
            padding: 2rem; /* Reduced */
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .modal-product-desc {
            color: #d3ced7;
            line-height: 1.6;
            margin: 1rem 0; /* Reduced */
            font-size: 1rem;
        }
        
        /* Footer with Social Media INLINE */
        .footer {
            padding: 1.5rem 0; /* Reduced */
            margin-top: 1rem; /* Reduced */
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0 1.5rem;
        }
        
        /* Social section - INLINE with text and icons */
        .social-section {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            flex-wrap: wrap;
        }
        
        .social-text {
            color: #d3ced7;
            font-size: 1.2rem;
            white-space: nowrap;
        }
        
        .social-icons {
            display: flex;
            gap: 1rem;
        }
        
        .social-icon {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, #0E3659 0%, #182D40 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2rem;
            color: #FFFFFF;
            transition: all 0.3s;
            border: 2px solid rgba(14, 54, 89, 0.5);
        }
        
        .social-icon:hover {
            background: linear-gradient(135deg, #182D40 0%, #0E3659 100%);
            color: #FFFFFF;
            border-color: #d3ced7;
            transform: translateY(-3px);
        }
        
        .copyright {
            text-align: center;
            padding-top: 1rem; /* Reduced */
            color: #d3ced7;
            width: 100%;
            font-size: 0.9rem;
            border-top: 1px solid rgba(14, 54, 89, 0.3);
        }
        
        /* PROFILE PAGE HEADER FIXES */
        .profile-hero-section {
            position: relative;
            max-width: 1150px;
            width: 100%;
            height: 300px;
            margin: 100px auto 0 auto; /* Removed bottom margin */
            overflow: hidden;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(14, 54, 89, 0.3);
        }
        
        .profile-header-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://images.unsplash.com/photo-1619566636858-adf3ef46400b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&h=1080&q=80'); /* Removed opacity overlay */
            background-size: cover;
            background-position: center;
            z-index: -1;
            border-radius: 12px;
        }
        
        /* PROFILE HEADER - Fixed centering */
        .profile-header {
            position: relative;
            background: rgba(24, 45, 64, 0.5);
            border-radius: 12px;
            padding: 1.5rem; /* Reduced */
            margin: -110px auto 1rem auto; /* Reduced bottom margin */
            max-width: 800px;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 1.5rem; /* Reduced */
            border: 1px solid rgba(14, 54, 89, 0.3);
            z-index: 2;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(5px);
            min-height: 140px; /* Reduced */
        }
        
        .profile-avatar {
            width: 120px; /* Reduced */
            height: 120px; /* Reduced */
            border-radius: 50%;
            background: linear-gradient(135deg, #0E3659 0%, #182D40 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem; /* Reduced */
            color: #FFFFFF;
            border: 4px solid rgba(12, 29, 47, 0.8); /* Reduced */
            flex-shrink: 0;
            overflow: hidden;
        }
        
        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .profile-info {
            flex: 1;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start;
        }
        
        /* Profile name - LEFT ALIGNED FOR DESKTOP ONLY */
        .profile-name {
            font-size: 1.6rem; /* Reduced */
            margin-bottom: 0.5rem; /* Reduced */
            color: #FFFFFF;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        /* VERIFIED BADGE - CLICKABLE TOOLTIP */
        .verified-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 22px;
            height: 22px;
            color: #FFFFFF;
            flex-shrink: 0;
            position: relative;
            vertical-align: middle;
            cursor: pointer;
        }
        
        .profile-name .verified-badge {
            width: 26px;
            height: 26px;
        }
        
        .post-user .verified-badge {
            width: 18px;
            height: 18px;
        }
        
        .profile-bio {
            color: #d3ced7;
            line-height: 1.6;
            margin-bottom: 0;
            font-size: 1rem;
            text-align: left;
            max-width: 100%;
        }
        
        .posts {
            display: flex;
            flex-direction: column;
            gap: 1rem; /* Reduced */
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* Post box - Fixed height */
        .post {
            background: rgba(24, 45, 64, 0.5);
            border-radius: 12px;
            padding: 1.2rem; /* Reduced */
            position: relative;
            border: 1px solid rgba(14, 54, 89, 0.3);
            z-index: 2;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(5px);
            height: auto;
            min-height: auto;
        }
        
        .post-header {
            display: flex;
            align-items: flex-start;
            margin-bottom: 0.8rem; /* Reduced */
            position: relative;
            padding-right: 40px;
        }
        
        .post-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, #0E3659 0%, #182D40 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 1rem;
            font-size: 1.1rem;
            flex-shrink: 0;
            overflow: hidden;
        }
        
        .post-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .post-user-info {
            flex: 1;
        }
        
        /* Post user name aligned properly */
        .post-user {
            font-weight: 600;
            color: #FFFFFF;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-bottom: 0.2rem;
            font-size: 1rem;
        }
        
        .post-time {
            color: #d3ced7;
            font-size: 0.85rem;
        }
        
        /* Post content - Fixed alignment */
        .post-content {
            line-height: 1.6;
            color: #FFFFFF;
            font-size: 1rem;
            white-space: pre-wrap;
            text-align: left;
            word-break: break-word;
            overflow-wrap: break-word;
            margin: 0.5rem 0 0.8rem 0; /* Reduced */
            padding: 0;
        }
        
        /* Style for links in posts - UNDERLINE */
        .post-content a {
            color: #4dabf7;
            text-decoration: underline;
            word-break: break-all;
        }
        
        .post-content a:hover {
            color: #74c0fc;
        }
        
        .post-actions {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 0.8rem; /* Reduced */
            padding-top: 0.8rem; /* Reduced */
            border-top: 1px solid rgba(14, 54, 89, 0.2);
        }
        
        /* Share button positioned top right */
        .post-share-button {
            background: linear-gradient(135deg, #0E3659 0%, #182D40 100%);
            color: #FFFFFF;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            transition: all 0.3s;
            position: absolute;
            top: 0;
            right: 0;
            z-index: 1;
        }
        
        .post-share-button:hover {
            background: linear-gradient(135deg, #182D40 0%, #0E3659 100%);
            transform: scale(1.1);
        }
        
        /* Like button */
        .post-like-button {
            background: transparent;
            color: #FFFFFF;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.2rem;
            transition: all 0.3s;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
        }
        
        .post-like-button:hover {
            color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
        }
        
        .post-like-button.liked {
            color: #ff6b6b;
        }
        
        .post-like-count {
            font-size: 0.95rem;
            color: #d3ced7;
        }
        
        /* Tooltip for verified badge - CLICKABLE MODAL */
        .verified-wrapper {
            position: relative;
            display: inline-flex;
            align-items: center;
        }
        
        .verified-tooltip-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 3000;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }
        
        .verified-tooltip-modal.active {
            display: flex;
        }
        
        .verified-tooltip-content {
            background: rgba(24, 45, 64, 0.95);
            border-radius: 12px;
            padding: 1.5rem; /* Reduced */
            max-width: 300px;
            width: 100%;
            text-align: center;
            border: 1px solid rgba(14, 54, 89, 0.5);
            position: relative;
        }
        
        .verified-tooltip-close {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            color: #d3ced7;
            font-size: 1.2rem;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Share modal */
        .share-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 3000;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }
        
        .share-modal.active {
            display: flex;
        }
        
        .share-container {
            background: rgba(24, 45, 64, 0.95);
            padding: 1.5rem; /* Reduced */
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            border: 1px solid rgba(14, 54, 89, 0.5);
            text-align: center;
        }
        
        .share-image {
            max-width: 100%;
            border-radius: 8px;
            margin-bottom: 1rem; /* Reduced */
            border: 1px solid rgba(14, 54, 89, 0.5);
        }
        
        .share-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1rem; /* Reduced */
        }
        
        /* Page switching */
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
        }
        
        /* ========== RESPONSIVE DESIGN ========== */
        
        /* Tablet View (768px - 991px) */
        @media (max-width: 991px) {
            /* Header adjustments */
            .header-container {
                padding: 0 1.2rem;
            }
            
            /* Hero section */
            .hero-section,
            .profile-hero-section {
                max-width: 100%;
                width: 100%;
                height: 300px;
                margin: 90px auto 0 auto; /* Removed bottom margin */
            }
            
            /* Products - 2 columns on tablet AND mobile */
            .products {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem; /* Reduced */
            }
            
            .section-title {
                font-size: 2rem;
            }
            
            .section-subtitle {
                font-size: 1rem;
                margin-bottom: 1rem; /* Reduced */
            }
            
            /* Show carousel arrows on tablet */
            .carousel-arrow {
                opacity: 1;
                background: rgba(12, 29, 47, 0.5);
                width: 32px;
                height: 32px;
            }
            
            /* Product modal column layout for tablet */
            .product-modal-content {
                flex-direction: column;
                max-width: 500px;
            }
            
            .modal-product-img-container {
                width: 100%;
                border-radius: 12px 12px 0 0;
                min-height: 300px;
            }
            
            /* Profile header adjustments */
            .profile-header {
                margin: -50px auto 1rem auto; /* Reduced bottom margin */
                padding: 1.2rem; /* Reduced */
                gap: 1.2rem; /* Reduced */
            }
            
            .profile-avatar {
                width: 100px; /* Reduced */
                height: 100px; /* Reduced */
            }
            
            .profile-name {
                font-size: 1.4rem; /* Reduced */
            }
        }
        
        /* Mobile View (max-width: 767px) */
        @media (max-width: 767px) {
            /* Mobile Header */
            .mobile-menu-toggle {
                display: block;
            }
            
            .nav-links {
                position: fixed;
                top: 0;
                right: -100%;
                width: 70%;
                height: 100vh;
                background: rgba(12, 29, 47, 0.98);
                flex-direction: column;
                align-items: center;
                justify-content: center;
                gap: 1.5rem; /* Reduced */
                transition: right 0.3s ease;
                z-index: 1001;
                padding: 1.5rem; /* Reduced */
            }
            
            .nav-links.active {
                right: 0;
            }
            
            .nav-links a {
                font-size: 1.3rem;
            }
            
            .logo-text {
                font-size: 1.1rem;
            }
            
            .logo-text span {
                font-size: 0.8rem;
            }
            
            /* Hero section mobile */
            .hero-section,
            .profile-hero-section {
                max-width: 90%;
                width: 100%;
                height: 250px;
            border-radius: 0px;
                margin: 100px auto 0 auto; /* Removed bottom margin */
            }
            
            /* Products - 2 columns on mobile (CHANGED from 1 to 2) */
            .products {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.8rem; /* Reduced */
            }
            
            .product-card {
                max-width: 100%;
            }
            
            /* Section titles mobile */
            .section-title {
                font-size: 1.8rem;
                margin-bottom: 0.3rem; /* Reduced */
            }
            
            .section-subtitle {
                font-size: 0.95rem;
                margin-bottom: 0.8rem; /* Reduced */
                padding: 0 0.5rem;
            }
            
            /* Show carousel arrows on mobile */
            .carousel-arrow {
                opacity: 1;
                background: rgba(12, 29, 47, 0.5);
                width: 28px; /* Reduced */
                height: 28px; /* Reduced */
                font-size: 0.8rem; /* Reduced */
            }
            
            /* Product modal column layout for mobile */
            .product-modal-content {
                flex-direction: column;
                max-width: 95%;
                margin: 0 auto;
            }
            
            .modal-product-img-container {
                width: 100%;
                min-height: 250px;
                border-radius: 12px 12px 0 0;
            }
            
            .modal-product-info {
                padding: 1.2rem; /* Reduced */
            }
            
            /* Profile header mobile */
            .profile-header {
                flex-direction: column;
                text-align: center;
                padding: 1.2rem; /* Reduced */
                gap: 1rem; /* Reduced */
                max-width: 80%;
                margin: -110px auto 1rem auto; /* Reduced bottom margin */
            }
            
            .profile-info {
                min-width: 100%;
                align-items: center;
            }
            
            .profile-name {
                justify-content: center;
                font-size: 1.4rem; /* Reduced */
                text-align: center;
                width: 100%;
            }
            
            .profile-bio {
                text-align: center;
                font-size: 0.95rem;
            }
            
            .profile-avatar {
                width: 90px; /* Reduced */
                height: 90px; /* Reduced */
                margin-top: 0;
            }
            
            /* Social section mobile */
            .social-section {
                flex-direction: column;
                gap: 0.8rem; /* Reduced */
                text-align: center;
            }
            
            .social-text {
                font-size: 1.1rem;
            }
            
            .social-icons {
                gap: 0.8rem;
            }
            
            .social-icon {
                width: 42px;
                height: 42px;
                font-size: 1.1rem;
            }
            
            /* Posts mobile */
            .post {
                padding: 1rem;
            }
            
            .post-content {
                font-size: 0.95rem;
                line-height: 1.5;
            }
            
            .post-avatar {
                width: 40px;
                height: 40px;
                margin-right: 0.8rem;
            }
            
            .post-user {
                font-size: 0.95rem;
            }
            
            .post-time {
                font-size: 0.8rem;
            }
            
            .post-like-button {
                font-size: 1.1rem;
                padding: 0.3rem 0.6rem;
            }
        }
        
        /* Small Mobile View (max-width: 480px) */
        @media (max-width: 480px) {
            .header-container {
                padding: 0 1rem;
            }
            
            .container {
                padding: 0 1rem;
            }
            
            .hero-section,
            .profile-hero-section {
                height: 220px;
                margin: 70px auto 0 auto; /* Removed bottom margin */
            }
            
            .series-section {
                padding: 0.3rem 0; /* Reduced */
                margin: 10px 0 0 0; /* Only 10px top margin */
            }
            
            .section-title {
                font-size: 1.6rem;
            }
            
            .section-subtitle {
                font-size: 0.9rem;
                margin-bottom: 0.8rem; /* Reduced */
            }
            
            .profile-section {
                margin: 1rem 0; /* Reduced */
            }
            
            .footer {
                padding: 1.2rem 0; /* Reduced */
                margin-top: 1rem; /* Reduced */
            }
            
            .products {
                gap: 0.6rem; /* Reduced */
            }
            
            .product-info {
                padding: 1rem; /* Reduced */
            }
            
            .product-name {
                font-size: 1.1rem;
            }
            
            .product-price {
                font-size: 1.1rem;
            }
            
            .buy-button {
                padding: 0.7rem; /* Reduced */
                font-size: 0.95rem;
            }
            
            .profile-header {
                padding: 1rem; /* Reduced */
                gap: 0.8rem; /* Reduced */
                margin: -30px auto 0.8rem auto; /* Reduced bottom margin */
            }
            
            .profile-avatar {
                width: 80px; /* Reduced */
                height: 80px; /* Reduced */
            }
            
            .profile-name {
                font-size: 1.2rem; /* Reduced */
            }
            
            .profile-bio {
                font-size: 0.9rem;
            }
            
            .post {
                padding: 0.8rem; /* Reduced */
            }
            
            .post-header {
                margin-bottom: 0.6rem; /* Reduced */
                padding-right: 35px;
            }
            
            .post-share-button {
                width: 32px;
                height: 32px;
                font-size: 0.8rem;
            }
            
            .post-actions {
                margin-top: 0.6rem; /* Reduced */
                padding-top: 0.6rem; /* Reduced */
            }
        }
        
        /* Very Small Screens (max-width: 360px) */
        @media (max-width: 360px) {
            .logo-container {
                gap: 0.7rem;
            }
            
            .logo-image {
                width: 45px;
                height: 45px;
            }
            
            .logo-text {
                font-size: 1rem;
            }
            
            .logo-text span {
                font-size: 0.75rem;
            }
            
            .profile-name {
                font-size: 1.1rem; /* Reduced */
            }
            
            .profile-avatar {
                width: 70px; /* Reduced */
                height: 70px; /* Reduced */
            }
            
            .social-icon {
                width: 38px;
                height: 38px;
                font-size: 1rem;
            }
            
            /* For very small screens, keep 2 columns but reduce gap */
            .products {
                gap: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Homepage Header (Separated) -->
    <header class="header" id="main-header">
        <div class="header-container">
            <div class="logo-container">
                <img src="images/Logo.png" alt="Trulune Malaysia Logo" class="logo-image">
                <div class="logo-text">Trulune Malaysia <span>Everyday scents. Timeless allure.</span></div>
            </div>
            
            <button class="mobile-menu-toggle" id="mobileMenuToggle">
                <i class="fas fa-bars"></i>
            </button>
            
            <ul class="nav-links" id="navLinks">
                <li><a href="#" class="nav-home active" onclick="switchPage('home')">Home</a></li>
                <li><a href="#" class="nav-profile" onclick="switchPage('profile'); closeMobileMenu()">Profile</a></li>
            </ul>
        </div>
    </header>

    <!-- Homepage Featured Image Slider -->
    <div id="home-hero" class="hero-section">
        <div class="slider-container">
            <div class="slide slide-1 active"></div>
            <div class="slide slide-2"></div>
            
            <div class="slider-indicators">
                <div class="indicator active" data-slide="0"></div>
                <div class="indicator" data-slide="1"></div>
            </div>
        </div>
    </div>

    <!-- Profile Page Header with Background Image -->
    <div id="profile-hero" class="profile-hero-section" style="display:none;">
        <div class="profile-header-image"></div>
    </div>

    <!-- Home Page -->
    <main id="home-page" class="page active container">
        <!-- Fruitee Series Products -->
        <section class="series-section">
            <h2 class="section-title">Fruitee Series</h2>
            <p class="section-subtitle">Our first line of fruit-based üçá üçä üçé üçí</p>
            
            <div class="products">
                <!-- Product 1 with Carousel -->
                <div class="product-card" data-product="1">
                    <div class="product-img-container">
                        <div class="product-img-carousel" id="carousel-1">
                            <div class="carousel-slide">
                                <img src="https://images.unsplash.com/photo-1572490122747-3968b75cc699?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&h=600&q=80" alt="Fruitee Blend">
                            </div>
                            <div class="carousel-slide">
                                <img src="https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&h=600&q=80" alt="Fruitee Blend - View 2">
                            </div>
                            <div class="carousel-slide">
                                <img src="https://images.unsplash.com/photo-1565958011703-44f9829ba187?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&h=600&q=80" alt="Fruitee Blend - View 3">
                            </div>
                        </div>
                        
                        <!-- Carousel Navigation Arrows -->
                        <button class="carousel-arrow carousel-arrow-left" onclick="carouselPrev(1)">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="carousel-arrow carousel-arrow-right" onclick="carouselNext(1)">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                        
                        <div class="carousel-dots" id="dots-1">
                            <div class="carousel-dot active" data-slide="0"></div>
                            <div class="carousel-dot" data-slide="1"></div>
                            <div class="carousel-dot" data-slide="2"></div>
                        </div>
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">Fruitee Blend</h3>
                        <div class="product-price">RM 49.90</div>
                        <a href="https://payment-link.com/fruitee-blend" target="_blank" class="buy-button">Get Yours Now</a>
                    </div>
                </div>
                
                <!-- Product 2 with Carousel -->
                <div class="product-card" data-product="2">
                    <div class="product-img-container">
                        <div class="product-img-carousel" id="carousel-2">
                            <div class="carousel-slide">
                                <img src="https://images.unsplash.com/photo-1572490122747-3968b75cc699?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&h=600&q=80" alt="Fruitee Boost">
                            </div>
                            <div class="carousel-slide">
                                <img src="https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&h=600&q=80" alt="Fruitee Boost - View 2">
                            </div>
                        </div>
                        
                        <!-- Carousel Navigation Arrows -->
                        <button class="carousel-arrow carousel-arrow-left" onclick="carouselPrev(2)">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="carousel-arrow carousel-arrow-right" onclick="carouselNext(2)">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                        
                        <div class="carousel-dots" id="dots-2">
                            <div class="carousel-dot active" data-slide="0"></div>
                            <div class="carousel-dot" data-slide="1"></div>
                        </div>
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">Fruitee Boost</h3>
                        <div class="product-price">RM 59.90</div>
                        <a href="https://payment-link.com/fruitee-boost" target="_blank" class="buy-button">Order Today</a>
                    </div>
                </div>
                
                <!-- Product 3 with Carousel -->
                <div class="product-card" data-product="3">
                    <div class="product-img-container">
                        <div class="product-img-carousel" id="carousel-3">
                            <div class="carousel-slide">
                                <img src="https://images.unsplash.com/photo-1572490122747-3968b75cc699?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&h=600&q=80" alt="Fruitee Defense">
                            </div>
                            <div class="carousel-slide">
                                <img src="https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&h=600&q=80" alt="Fruitee Defense - View 2">
                            </div>
                            <div class="carousel-slide">
                                <img src="https://images.unsplash.com/photo-1565958011703-44f9829ba187?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&h=600&q=80" alt="Fruitee Defense - View 3">
                            </div>
                        </div>
                        
                        <!-- Carousel Navigation Arrows -->
                        <button class="carousel-arrow carousel-arrow-left" onclick="carouselPrev(3)">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="carousel-arrow carousel-arrow-right" onclick="carouselNext(3)">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                        
                        <div class="carousel-dots" id="dots-3">
                            <div class="carousel-dot active" data-slide="0"></div>
                            <div class="carousel-dot" data-slide="1"></div>
                            <div class="carousel-dot" data-slide="2"></div>
                        </div>
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">Fruitee Defense</h3>
                        <div class="product-price">RM 54.90</div>
                        <a href="https://payment-link.com/fruitee-defense" target="_blank" class="buy-button">Buy Now</a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Profile Page -->
    <main id="profile-page" class="page container">
        <section class="profile-section">
            <!-- Profile Header -->
            <section class="profile-header">
                <div class="profile-avatar">
                    <img src="images/Logo.png" alt="Trulune Malaysia Logo">
                </div>
                <div class="profile-info">
                    <h1 class="profile-name">
                        Trulune Malaysia 
                        <span class="verified-badge" onclick="openVerifiedTooltip()">
                            <img src="images/verified.svg" style="width: 100%; height: 100%;" alt="Verified">
                        </span>
                    </h1>
                    <p class="profile-bio">Trulune starts with a simple idea, a small collection of scents chosen for comfort and everyday wear.</p>
                </div>
            </section>
            
            <!-- Updates Feed -->
            <h2 class="section-title" style="text-align: center; margin-top: 1rem;">Updates</h2>
            <div class="posts" id="posts-container">
                <!-- Posts will be loaded here from Firebase -->
            </div>
        </section>
    </main>

    <!-- Footer with Social Icons INLINE -->
    <footer class="footer">
        <div class="footer-content">
            <div class="social-section">
                <p class="social-text">Follow us on social media</p>
                <div class="social-icons">
                    <a href="https:t.me/trulune" class="social-icon">
                        <i class="fab fa-telegram"></i>
                    </a>
                    <a href="https://tiktok.com/@trulunemalaysia" class="social-icon">
                        <i class="fab fa-tiktok"></i>
                    </a>
                    <a href="https://instagram.com/trulune" class="social-icon">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a href="https://facebook.com/trulune" class="social-icon">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                </div>
            </div>
            <div class="copyright">
                &copy; <span id="current-year"></span> Trulune Malaysia. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- Product Modal for ALL views -->
    <div class="product-modal" id="productModal">
        <div class="product-modal-content">
            <button class="modal-close" onclick="closeProductModal()">
                <i class="fas fa-times"></i>
            </button>
            <div class="modal-product-img-container">
                <div class="modal-product-img-carousel" id="modalCarousel">
                    <!-- Slides will be added dynamically -->
                </div>
                
                <!-- Carousel Navigation Arrows -->
                <button class="modal-carousel-arrow modal-carousel-arrow-left" onclick="modalCarouselPrev()">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="modal-carousel-arrow modal-carousel-arrow-right" onclick="modalCarouselNext()">
                    <i class="fas fa-chevron-right"></i>
                </button>
                
                <div class="modal-carousel-dots" id="modalDots">
                    <!-- Dots will be added dynamically -->
                </div>
            </div>
            <div class="modal-product-info">
                <h3 id="modalProductName" class="product-name"></h3>
                <p id="modalProductDesc" class="modal-product-desc"></p>
                <div id="modalProductPrice" class="product-price"></div>
                <a id="modalProductLink" href="#" target="_blank" class="buy-button">Buy Now</a>
            </div>
        </div>
    </div>

    <!-- Verified Tooltip Modal -->
    <div class="verified-tooltip-modal" id="verifiedTooltipModal">
        <div class="verified-tooltip-content">
            <button class="verified-tooltip-close" onclick="closeVerifiedTooltip()">
                <i class="fas fa-times"></i>
            </button>
            <div style="margin-bottom: 1rem;">
                <span class="verified-badge" style="width: 40px; height: 40px; margin-bottom: 0.5rem;">
                    <img src="images/verified.svg" style="width: 100%; height: 100%;" alt="Verified">
                </span>
            </div>
            <h3 style="color: #FFFFFF; margin-bottom: 0.5rem;">Verified Account</h3>
            <p style="color: #d3ced7; font-size: 0.9rem;">
                This is the official presence of Trulune Malaysia on this platform.
            </p>
        </div>
    </div>

    <!-- Share Modal -->
    <div class="share-modal" id="shareModal">
        <div class="share-container">
            <h3 style="color: #FFFFFF; margin-bottom: 1rem;">Share this Post</h3>
            <img id="shareImage" class="share-image" alt="Shareable Post">
            <div class="share-buttons">
                <button class="buy-button" onclick="downloadShareImage()">
                    <i class="fas fa-download"></i> Download Image
                </button>
                <button class="buy-button" style="background: rgba(12, 29, 47, 0.8);" onclick="closeShareModal()">
                    <i class="fas fa-times"></i> Close
                </button>
            </div>
        </div>
    </div>

    <script>
        // === FIREBASE CONFIG ===
        const firebaseConfig = {
            apiKey: "AIzaSyDoBtFtFEs6Cd-uU6dNvwXNAuXOd1R1r10",
            authDomain: "post-58eb6.firebaseapp.com",
            projectId: "post-58eb6",
            storageBucket: "post-58eb6.firebasestorage.app",
            messagingSenderId: "448356917822",
            appId: "1:448356917822:web:8251dc0ecff7fcd0efe76f"
        };

        // === INITIALIZE FIREBASE ===
        let db = null;
        let postsListener = null;
        
        if (typeof firebase === 'undefined') {
            console.error("Firebase SDK not loaded!");
        } else {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            console.log("Firebase initialized successfully!");
            
            // === IMAGE SLIDER ===
            let currentSlide = 0;
            const slides = document.querySelectorAll('.slide');
            const indicators = document.querySelectorAll('.indicator');
            
            function initSlider() {
                if (slides.length === 0) return;
                
                // Auto slide every 5 seconds
                setInterval(() => {
                    nextSlide();
                }, 5000);
                
                // Add click events to indicators
                indicators.forEach((indicator, index) => {
                    indicator.addEventListener('click', () => {
                        goToSlide(index);
                    });
                });
            }
            
            function nextSlide() {
                slides[currentSlide].classList.remove('active');
                indicators[currentSlide].classList.remove('active');
                
                currentSlide = (currentSlide + 1) % slides.length;
                
                slides[currentSlide].classList.add('active');
                indicators[currentSlide].classList.add('active');
            }
            
            function goToSlide(index) {
                slides[currentSlide].classList.remove('active');
                indicators[currentSlide].classList.remove('active');
                
                currentSlide = index;
                
                slides[currentSlide].classList.add('active');
                indicators[currentSlide].classList.add('active');
            }
            
            // === PRODUCT CAROUSEL FUNCTIONALITY ===
            let carouselStates = {
                1: { currentSlide: 0, totalSlides: 3 },
                2: { currentSlide: 0, totalSlides: 2 },
                3: { currentSlide: 0, totalSlides: 3 }
            };
            
            function initProductCarousels() {
                // Initialize each product carousel at slide 0
                Object.keys(carouselStates).forEach(productId => {
                    goToCarouselSlide(parseInt(productId), 0);
                });
            }
            
            function carouselNext(productId) {
                const state = carouselStates[productId];
                const nextSlide = (state.currentSlide + 1) % state.totalSlides;
                goToCarouselSlide(productId, nextSlide);
            }
            
            function carouselPrev(productId) {
                const state = carouselStates[productId];
                const prevSlide = state.currentSlide === 0 ? state.totalSlides - 1 : state.currentSlide - 1;
                goToCarouselSlide(productId, prevSlide);
            }
            
            function goToCarouselSlide(productId, slideIndex) {
                const carousel = document.getElementById(`carousel-${productId}`);
                const dotsContainer = document.getElementById(`dots-${productId}`);
                
                if (!carousel || !dotsContainer) return;
                
                const dots = dotsContainer.querySelectorAll('.carousel-dot');
                const state = carouselStates[productId];
                
                // Ensure slideIndex is within bounds
                if (slideIndex < 0) slideIndex = state.totalSlides - 1;
                if (slideIndex >= state.totalSlides) slideIndex = 0;
                
                // Move carousel
                carousel.style.transform = `translateX(-${slideIndex * 100}%)`;
                
                // Update active dot
                dots.forEach(dot => dot.classList.remove('active'));
                if (dots[slideIndex]) {
                    dots[slideIndex].classList.add('active');
                }
                
                // Update state
                state.currentSlide = slideIndex;
            }
            
            // === MODAL CAROUSEL FUNCTIONALITY ===
            let modalCarouselState = { currentSlide: 0, totalSlides: 0 };
            
            function initModalCarousel(images) {
                const modalCarousel = document.getElementById('modalCarousel');
                const modalDots = document.getElementById('modalDots');
                
                // Clear previous content
                modalCarousel.innerHTML = '';
                modalDots.innerHTML = '';
                
                // Add slides
                images.forEach((imgSrc, index) => {
                    const slide = document.createElement('div');
                    slide.className = 'modal-carousel-slide';
                    slide.innerHTML = `<img src="${imgSrc}" alt="Product Image">`;
                    modalCarousel.appendChild(slide);
                    
                    // Add dot
                    const dot = document.createElement('div');
                    dot.className = `modal-carousel-dot ${index === 0 ? 'active' : ''}`;
                    dot.setAttribute('data-slide', index);
                    dot.addEventListener('click', () => goToModalCarouselSlide(index));
                    modalDots.appendChild(dot);
                });
                
                // Initialize state
                modalCarouselState.totalSlides = images.length;
                modalCarouselState.currentSlide = 0;
                goToModalCarouselSlide(0);
            }
            
            function modalCarouselNext() {
                const nextSlide = (modalCarouselState.currentSlide + 1) % modalCarouselState.totalSlides;
                goToModalCarouselSlide(nextSlide);
            }
            
            function modalCarouselPrev() {
                const prevSlide = modalCarouselState.currentSlide === 0 ? modalCarouselState.totalSlides - 1 : modalCarouselState.currentSlide - 1;
                goToModalCarouselSlide(prevSlide);
            }
            
            function goToModalCarouselSlide(slideIndex) {
                const modalCarousel = document.getElementById('modalCarousel');
                const modalDots = document.querySelectorAll('.modal-carousel-dot');
                
                if (!modalCarousel || modalDots.length === 0) return;
                
                // Ensure slideIndex is within bounds
                if (slideIndex < 0) slideIndex = modalCarouselState.totalSlides - 1;
                if (slideIndex >= modalCarouselState.totalSlides) slideIndex = 0;
                
                // Move carousel
                modalCarousel.style.transform = `translateX(-${slideIndex * 100}%)`;
                
                // Update active dot
                modalDots.forEach(dot => dot.classList.remove('active'));
                modalDots[slideIndex].classList.add('active');
                
                // Update state
                modalCarouselState.currentSlide = slideIndex;
            }
            
            // === PRODUCT MODAL FOR ALL VIEWS ===
            let currentProductModal = null;
            
            function openProductModal(productId) {
                const productCard = document.querySelector(`[data-product="${productId}"]`);
                if (!productCard) return;
                
                const productName = productCard.querySelector('.product-name').textContent;
                const productPrice = productCard.querySelector('.product-price').textContent;
                const productLink = productCard.querySelector('.buy-button').getAttribute('href');
                
                // Get description from data attribute
                const productDesc = productCard.getAttribute('data-desc') || "No description available.";
                
                // Get all images from carousel
                const images = [];
                const carousel = productCard.querySelector('.product-img-carousel');
                if (carousel) {
                    const slides = carousel.querySelectorAll('.carousel-slide img');
                    slides.forEach(slide => {
                        images.push(slide.getAttribute('src'));
                    });
                }
                
                document.getElementById('modalProductName').textContent = productName;
                document.getElementById('modalProductDesc').textContent = productDesc;
                document.getElementById('modalProductPrice').textContent = productPrice;
                document.getElementById('modalProductLink').setAttribute('href', productLink);
                
                // Initialize modal carousel
                initModalCarousel(images);
                
                document.getElementById('productModal').classList.add('active');
                currentProductModal = productId;
            }
            
            function closeProductModal() {
                document.getElementById('productModal').classList.remove('active');
                currentProductModal = null;
            }
            
            // === VERIFIED TOOLTIP MODAL ===
            function openVerifiedTooltip() {
                document.getElementById('verifiedTooltipModal').classList.add('active');
            }
            
            function closeVerifiedTooltip() {
                document.getElementById('verifiedTooltipModal').classList.remove('active');
            }
            
            // === SHARE FUNCTIONALITY ===
            let currentPostForShare = null;
            
            function openShareModal(postContent, postDate, postId) {
                currentPostForShare = { 
                    content: postContent, 
                    date: postDate,
                    id: postId
                };
                document.getElementById('shareModal').classList.add('active');
                generateShareImage();
            }
            
            function closeShareModal() {
                document.getElementById('shareModal').classList.remove('active');
                currentPostForShare = null;
            }
            
            function generateShareImage() {
                if (!currentPostForShare) return;
                
                const content = currentPostForShare.content || '';
                const contentLength = content.length;
                let containerHeight = 400;
                
                if (contentLength > 100) containerHeight = 500;
                if (contentLength > 200) containerHeight = 600;
                if (contentLength > 300) containerHeight = 700;
                if (contentLength > 400) containerHeight = 800;
                
                const container = document.createElement('div');
                container.style.cssText = `
                    width: 800px;
                    height: ${containerHeight}px;
                    background: linear-gradient(135deg, #0c1d2f 0%, #182D40 50%, #0E3659 100%);
                    padding: 40px;
                    color: white;
                    font-family: 'Lato', sans-serif;
                    display: flex;
                    flex-direction: column;
                    position: fixed;
                    left: -9999px;
                `;
                
                const logoUrl = 'images/Logo.png';
                const verifiedUrl = 'images/verified.svg';
                
                const header = `
                    <div style="display: flex; align-items: center; margin-bottom: 30px;">
                        <div style="width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(135deg, #0E3659 0%, #182D40 100%); display: flex; align-items: center; justify-content: center; margin-right: 20px; border: 3px solid rgba(211, 206, 215, 0.3); overflow: hidden;">
                            <img src="${logoUrl}" style="width: 100%; height: 100%; object-fit: cover;" alt="Trulune Logo" onerror="this.onerror=null; this.style.display='none'; this.parentElement.innerHTML='<span style=\\'color:white; font-size:24px;\\'>TL</span>';">
                        </div>
                        <div>
                            <div style="font-size: 28px; font-weight: bold; display: flex; align-items: center; gap: 10px;">
                                Trulune Malaysia 
                                <span style="background: linear-gradient(135deg, #0E3659 0%, #182D40 100%); width: 24px; height: 24px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; font-size: 14px;">
                                    <img src="${verifiedUrl}" style="width: 70%; height: 70%;" alt="Verified" onerror="this.onerror=null; this.style.display='none'; this.parentElement.innerHTML='<span style=\\'color:white;\\'>‚úì</span>';">
                                </span>
                            </div>
                            <div style="font-size: 16px; color: #d3ced7; margin-top: 5px;">Everyday scents. Timeless allure.</div>
                        </div>
                    </div>
                `;
                
                const contentDiv = `
                    <div style="flex: 1; display: flex; align-items: center; justify-content: center; padding: 20px 0;">
                        <div style="font-size: ${contentLength > 200 ? '28px' : '32px'}; line-height: 1.5; text-align: center; max-width: 600px; padding: 20px;">
                            "${content}"
                        </div>
                    </div>
                `;
                
                const footer = `
                    <div style="text-align: center; padding-top: 20px; border-top: 2px solid rgba(14, 54, 89, 0.3);">
                        <div style="font-size: 18px; color: #d3ced7;">${currentPostForShare.date}</div>
                    </div>
                `;
                
                container.innerHTML = header + contentDiv + footer;
                document.body.appendChild(container);
                
                // Generate the image
                html2canvas(container, {
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    backgroundColor: null
                }).then(canvas => {
                    document.getElementById('shareImage').src = canvas.toDataURL('image/png');
                    document.body.removeChild(container);
                }).catch(error => {
                    console.error("Error generating share image:", error);
                    alert("Error generating image. Please try again.");
                    document.body.removeChild(container);
                });
            }
            
            function downloadShareImage() {
                const link = document.createElement('a');
                link.download = 'trulune-post.png';
                link.href = document.getElementById('shareImage').src;
                link.click();
            }
            
            // === LIKE FUNCTIONALITY ===
            async function likePost(postId, currentLikes) {
                if (!db) {
                    console.error("Firebase not initialized");
                    return;
                }
                
                try {
                    const newLikes = (currentLikes || 0) + 1;
                    
                    // Update in Firebase
                    await db.collection('posts').doc(postId).update({
                        likes: newLikes
                    });
                    
                    // Update UI immediately
                    const likeButton = document.querySelector(`.post-like-button[data-post-id="${postId}"]`);
                    const likeCountElement = document.querySelector(`.post-like-count[data-post-id="${postId}"]`);
                    
                    if (likeButton && likeCountElement) {
                        likeButton.classList.add('liked');
                        likeCountElement.textContent = newLikes;
                        likeButton.innerHTML = 'ü§ç <span class="post-like-count">' + newLikes + '</span>';
                        likeButton.style.color = '#ff6b6b';
                    }
                    
                    return newLikes;
                } catch (error) {
                    console.error("Error liking post:", error);
                    return currentLikes;
                }
            }
            
            // === LOAD POSTS (WITH LIKE FUNCTIONALITY) ===
            async function loadPosts() {
                const postsContainer = document.getElementById('posts-container');
                
                if (!db) {
                    postsContainer.innerHTML = '<p style="text-align:center;color:#d3ced7;padding:2rem;">Database connection error. Please refresh.</p>';
                    return;
                }
                
                try {
                    const querySnapshot = await db.collection('posts')
                        .orderBy('createdAt', 'desc')
                        .limit(20)
                        .get();
                    
                    postsContainer.innerHTML = '';
                    
                    if (querySnapshot.empty) {
                        postsContainer.innerHTML = '<p style="text-align:center;color:#d3ced7;padding:2rem;">No updates yet. Check back soon!</p>';
                        return;
                    }
                    
                    querySnapshot.forEach((doc) => {
                        const post = doc.data();
                        const postId = doc.id;
                        const postElement = document.createElement('div');
                        postElement.className = 'post';
                        
                        let timeAgo = "Recently";
                        try {
                            if (post.createdAt) {
                                const postDate = post.createdAt.toDate();
                                timeAgo = formatTimeAgo(postDate);
                            }
                        } catch (e) {
                            console.log("Error formatting date:", e);
                        }
                        
                        // Clean post content
                        let postContent = post.content ? post.content.trim() : '';
                        
                        // Detect and underline links in post content
                        const urlRegex = /(https?:\/\/[^\s]+)/g;
                        postContent = postContent.replace(urlRegex, '<a href="$1" target="_blank" rel="noopener">$1</a>');
                        
                        // Escape quotes for the share function
                        const escapedContent = post.content ? post.content.replace(/'/g, "\\'").replace(/"/g, '&quot;').replace(/\n/g, '\\n') : '';
                        
                        postElement.innerHTML = `
                            <div class="post-header">
                                <div class="post-avatar">
                                    <img src="images/Logo.png" alt="Trulune Malaysia">
                                </div>
                                <div class="post-user-info">
                                    <div class="post-user">
                                        Trulune Malaysia 
                                        <span class="verified-badge" onclick="openVerifiedTooltip()">
                                            <img src="images/verified.svg" style="width: 100%; height: 100%;" alt="Verified">
                                        </span>
                                    </div>
                                    <div class="post-time">${timeAgo}</div>
                                </div>
                                <button class="post-share-button" onclick="openShareModal('${escapedContent}', '${timeAgo}', '${postId}')">
                                    <i class="fas fa-share"></i>
                                </button>
                            </div>
                            <div class="post-content">
                                ${postContent}
                            </div>
                            <div class="post-actions">
                                <button class="post-like-button" data-post-id="${postId}" onclick="likePost('${postId}', ${post.likes || 0})">
                                    ü§ç
                                    <span class="post-like-count" data-post-id="${postId}">${post.likes || 0}</span>
                                </button>
                            </div>
                        `;
                        
                        postsContainer.appendChild(postElement);
                    });
                } catch (error) {
                    console.error("Error loading posts:", error);
                    postsContainer.innerHTML = '<p style="text-align:center;color:#d3ced7;padding:2rem;">Error loading posts. Please refresh.</p>';
                }
            }
            
            function formatTimeAgo(date) {
                const now = new Date();
                const diff = now - date;
                const seconds = Math.floor(diff / 1000);
                
                if (seconds < 60) return "Just now";
                
                const minutes = Math.floor(seconds / 60);
                if (minutes < 60) return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;
                
                const hours = Math.floor(minutes / 60);
                if (hours < 24) return `${hours} hour${hours > 1 ? 's' : ''} ago`;
                
                const days = Math.floor(hours / 24);
                if (days < 7) return `${days} day${days > 1 ? 's' : ''} ago`;
                
                return date.toLocaleDateString('en-MY', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
            }
            
            // === SWITCH PAGE ===
            function switchPage(page) {
                // Hide all pages
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                document.getElementById('home-hero').style.display = 'none';
                document.getElementById('profile-hero').style.display = 'none';
                
                // Show selected page
                document.getElementById(`${page}-page`).classList.add('active');
                if (page === 'home') {
                    document.getElementById('home-hero').style.display = 'block';
                    initSlider();
                    initProductCarousels();
                } else {
                    document.getElementById('profile-hero').style.display = 'block';
                    loadPosts();
                }
                
                // Update navigation
                document.querySelectorAll('.nav-links a').forEach(link => link.classList.remove('active'));
                document.querySelectorAll(`.nav-${page}`).forEach(link => link.classList.add('active'));
                
                window.scrollTo(0, 0);
                closeMobileMenu();
            }
        }
        
        function toggleMobileMenu() {
            document.getElementById('navLinks').classList.toggle('active');
        }
        
        function closeMobileMenu() {
            document.getElementById('navLinks').classList.remove('active');
        }
        
        // === STICKY HEADER ON SCROLL ===
        function handleScroll() {
            const header = document.getElementById('main-header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        }
        
        // === INITIALIZE PAGE ===
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('current-year').textContent = new Date().getFullYear();
            
            // Add product descriptions to data attributes
            const products = [
                {
                    id: 1,
                    desc: "A delightful mix of tropical fruits packed with essential vitamins and antioxidants for daily health. This blend combines mango, pineapple, and passion fruit for a refreshing taste that supports overall wellness."
                },
                {
                    id: 2,
                    desc: "Energy-boosting formula with natural fruit extracts to enhance vitality and mental clarity. Contains guarana, acai berries, and citrus fruits to provide sustained energy throughout the day without crashes."
                },
                {
                    id: 3,
                    desc: "Immune-supporting blend with vitamin C-rich fruits to help protect against seasonal threats. Features oranges, kiwis, and strawberries to strengthen your body's natural defenses."
                }
            ];
            
            products.forEach(product => {
                const card = document.querySelector(`[data-product="${product.id}"]`);
                if (card) {
                    card.setAttribute('data-desc', product.desc);
                }
            });
            
            // Mobile menu
            document.getElementById('mobileMenuToggle').addEventListener('click', toggleMobileMenu);
            
            // Close mobile menu when clicking outside
            document.addEventListener('click', function(event) {
                const navLinks = document.getElementById('navLinks');
                const mobileToggle = document.getElementById('mobileMenuToggle');
                
                if (navLinks.classList.contains('active') && 
                    !navLinks.contains(event.target) && 
                    !mobileToggle.contains(event.target)) {
                    closeMobileMenu();
                }
            });
            
            // Initialize scroll handler for transparent header
            window.addEventListener('scroll', handleScroll);
            
            // Initialize slider if on home page
            if (document.getElementById('home-page').classList.contains('active')) {
                if (typeof initSlider === 'function') {
                    initSlider();
                }
                if (typeof initProductCarousels === 'function') {
                    initProductCarousels();
                }
            }
            
            // Add click events to product cards for ALL views
            document.querySelectorAll('.product-card').forEach(card => {
                card.addEventListener('click', function(e) {
                    // Don't open modal if clicking on buy button or carousel arrows
                    if (!e.target.closest('.buy-button') && !e.target.closest('.carousel-arrow')) {
                        const productId = this.getAttribute('data-product');
                        openProductModal(productId);
                    }
                });
            });
            
            // Close modals when clicking outside
            document.getElementById('productModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeProductModal();
                }
            });
            
            document.getElementById('verifiedTooltipModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeVerifiedTooltip();
                }
            });
            
            document.getElementById('shareModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeShareModal();
                }
            });
            
            // Close modals with escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeProductModal();
                    closeVerifiedTooltip();
                    closeShareModal();
                }
            });
            
            // Initialize scroll position for header
            handleScroll();
            
            // Fix for mobile view - force reflow on resize
            window.addEventListener('resize', function() {
                document.body.style.display = 'none';
                document.body.offsetHeight; // Trigger reflow
                document.body.style.display = '';
            });
        });
    </script>
</body>
</html>
